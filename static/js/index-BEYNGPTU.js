var q=(e,t,n)=>new Promise((a,o)=>{var r=u=>{try{f(n.next(u))}catch(d){o(d)}},c=u=>{try{f(n.throw(u))}catch(d){o(d)}},f=u=>u.done?a(u.value):Promise.resolve(u.value).then(r,c);f((n=n.apply(e,t)).next())});import{e as ne,f as R,q as h,p as J,C as ae,D as T,s as E,E as I,G as Q}from"./index-dL88sIup.js";const re={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};var oe=Object.defineProperty,U=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,k=(e,t,n)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x=(e,t)=>{for(var n in t||(t={}))ie.call(t,n)&&k(e,n,t[n]);if(U)for(var n of U(t))le.call(t,n)&&k(e,n,t[n]);return e};function X(...e){return t=>e.reduceRight((n,a)=>a(n),t)}function _(e){return function t(...n){return n.length>=e.length?e.apply(this,n):(...a)=>t.apply(this,[...n,...a])}}function Z(e,t){return Object.keys(t).forEach(n=>{t[n]instanceof Object&&e[n]&&Object.assign(t[n],Z(e[n],t[n]))}),x(x({},e),t)}function b(e){return Object.prototype.toString.call(e).includes("Object")}function O(e){return typeof e=="function"}function ue(e){return Reflect.ownKeys(e).length===0}function ce(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const se={type:"cancelation",msg:"operation is manually canceled"};function V(e){let t=!1;const n=new Promise((a,o)=>{e.then(r=>t?o(se):a(r)),e.catch(o)});return Object.assign(n,{cancel(){t=!0}}),n}const L={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"An unknown error occurred",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })
  `};function de(){console.warn(L.deprecation)}function fe(e,t){throw new Error(e[t]||L.default)}const g=_(fe)(L);function ve(e){return e||g("configIsRequired"),b(e)||g("configType"),e.urls?(de(),{paths:{vs:e.urls.monacoBase}}):e}function ge(e,t){return b(t)||g("changeType"),Object.keys(t).some(n=>!ce(e,n))&&g("changeField"),t}function pe(e){O(e)||g("selectorType")}function he(e){O(e)||b(e)||g("handlerType"),b(e)&&Object.values(e).some(t=>!O(t))&&g("handlersType")}function ye(e){e||g("initialIsRequired"),b(e)||g("initialType"),ue(e)&&g("initialContent")}const w={config:ve,changes:ge,selector:pe,handler:he,initial:ye};var me=Object.defineProperty,A=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable,F=(e,t,n)=>t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D=(e,t)=>{for(var n in t||(t={}))_e.call(t,n)&&F(e,n,t[n]);if(A)for(var n of A(t))we.call(t,n)&&F(e,n,t[n]);return e};function be(e,t){return O(t)?t(e.current):t}function Oe(e,t){return e.current=D(D({},e.current),t),t}function Se(e,t,n){return O(t)?t(e.current):Object.keys(n).forEach(a=>{var o;return(o=t[a])==null?void 0:o.call(t,e.current[a])}),n}function Me(e,t={}){w.initial(e),w.handler(t);const n={current:e},a=_(Se)(n,t),o=_(Oe)(n),r=_(w.changes)(e),c=_(be)(n);function f(d=p=>p){return w.selector(d),d(n.current)}function u(d){X(a,o,r,c)(d)}return[f,u]}var H=Object.getOwnPropertySymbols,je=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,Ee=(e,t)=>{var n={};for(var a in e)je.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&H)for(var a of H(e))t.indexOf(a)<0&&Pe.call(e,a)&&(n[a]=e[a]);return n};const[S,C]=Me({config:re,isInitialized:!1,resolve:null,reject:null,monaco:null}),$=new Promise((e,t)=>C({resolve:e,reject:t}));function Ce(e){const t=w.config(e),{monaco:n}=t,a=Ee(t,["monaco"]);C(o=>({config:Z(o.config,a),monaco:n}))}function Ie(){const e=S(({monaco:t,isInitialized:n,resolve:a})=>({monaco:t,isInitialized:n,resolve:a}));if(!e.isInitialized){if(C({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),V($);if(window.monaco&&window.monaco.editor)return ee(window.monaco),e.resolve(window.monaco),V($);X(Ve,Te)(Re)}return V($)}function Ve(e){return document.body.appendChild(e)}function $e(e){const t=document.createElement("script");return e&&(t.src=e),t}function Te(e){const t=S(({config:a,reject:o})=>({config:a,reject:o})),n=$e(`${t.config.paths.vs}/loader.js`);return n.onload=()=>e(),n.onerror=t.reject,n}function Re(){const e=S(({config:n,resolve:a,reject:o})=>({config:n,resolve:a,reject:o})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],n=>{ee(n),e.resolve(n)},n=>{e.reject(n)})}function ee(e){S().monaco||C({monaco:e})}function Le(){return S(({monaco:e})=>e)}var B={config:Ce,init:Ie,getMonacoInstance:Le};function Ne(){}function z(e){return/^\d+$/.test(e)?`${e}px`:e}function G(e,t,n,a){return qe(e,a)||Ue(e,t,n,a)}function qe(e,t){return e.editor.getModel(te(e,t))}function Ue(e,t,n,a){return e.editor.createModel(t,n,a?te(e,a):void 0)}function te(e,t){return e.Uri.parse(t)}function W(e){return typeof e=="function"?e():e}function ke(e,t){const n=E(()=>({display:"flex",position:"relative",textAlign:"initial",width:z(e.width),height:z(e.height)})),a=E(()=>{const r={width:"100%"};return t.value||(r.display="none"),r}),o=E(()=>({display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}));return{getWrapperStyle:n,getContainerStyle:a,getLoadingStyle:o}}function xe(){const e=T(B.getMonacoInstance()),t=R(!1);let n;return J(()=>q(null,null,function*(){try{if(e.value)return;n=B.init(),e.value=yield n}catch(o){(o==null?void 0:o.type)!=="cancelation"?(t.value=!0,console.error("Monaco initialization error:",o)):t.value=!1}})),{monacoRef:e,unload:()=>n==null?void 0:n.cancel(),isLoadFailed:t}}function Ae(e,t,n){const{monacoRef:a,unload:o,isLoadFailed:r}=xe(),c=T(null),f=T(null),u=E(()=>!!a.value&&!!c.value),{getWrapperStyle:d,getContainerStyle:p,getLoadingStyle:y}=ke({width:e.width,height:e.height},u);function M(l){return function(...s){u.value&&l.apply(this,s)}}return h(()=>e.theme,M(l=>{var s;return(s=a.value)==null?void 0:s.editor.setTheme(l)})),h(()=>e.options,l=>{var s;return(s=c.value)==null?void 0:s.updateOptions(l)},{deep:!0}),{render:()=>{var l,s,v;return I("section",{style:d.value},[!u.value&&I("div",{style:y.value},r.value?t.slots.failure?W((l=t.slots)==null?void 0:l.failure):"load failed":(s=t.slots)!=null&&s.loading?W((v=t.slots)==null?void 0:v.loading):"loading..."),I("div",{ref:f,key:n,style:p.value,class:e.className})])},monacoRef:a,containerRef:f,editorRef:c,unload:o,whenMonacoIsReady:M}}function Fe(e,t,n){const a=R(Ne),o=h(()=>[t,n],()=>{if(t.value&&n.value){Q(()=>o());const r=t.value.editor.onDidChangeMarkers(c=>{var f,u;const d=(u=(f=n.value)==null?void 0:f.getModel())==null?void 0:u.uri;if(d&&c.find(y=>y.path===d.path)){const y=t.value.editor.getModelMarkers({resource:d});e("validate",y)}});a.value=()=>r==null?void 0:r.dispose()}});return{disposeValidator:a}}const De={defaultValue:{type:String},defaultLanguage:{type:String},defaultPath:{type:String},value:{type:String,value:""},language:{type:String,default:"javascript"},path:{type:String,default:""},theme:{type:String,default:"light"},line:{type:Number},options:{type:Object,default:()=>({})},overrideServices:{type:Object},saveViewState:{type:Boolean,default:!0},keepCurrentModel:{type:Boolean,default:!1},width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},className:{type:String}};var He=Object.defineProperty,K=Object.getOwnPropertySymbols,Be=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,Y=(e,t,n)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ge=(e,t)=>{for(var n in t||(t={}))Be.call(t,n)&&Y(e,n,t[n]);if(K)for(var n of K(t))ze.call(t,n)&&Y(e,n,t[n]);return e};const P=new Map;var Ye=ne({name:"MonacoEditor",props:De,emits:["update:value","beforeMount","mount","change","validate"],slots:Object,setup(e,t){const{emit:n}=t,{render:a,containerRef:o,editorRef:r,monacoRef:c,unload:f,whenMonacoIsReady:u}=Ae(e,t,"vue-monaco-editor"),{disposeValidator:d}=Fe(n,c,r),p=R(!1);h(()=>e.path,u((i,l)=>{var s,v,j;const m=G(c.value,e.defaultValue||e.value||"",e.defaultLanguage||e.language||"",e.path||e.defaultPath||"");m!==((s=r.value)==null?void 0:s.getModel())&&(e.saveViewState&&P.set(l,r.value.saveViewState()),(v=r.value)==null||v.setModel(m),e.saveViewState&&((j=r.value)==null||j.restoreViewState(P.get(i))))})),h(()=>e.value,u(i=>{!r.value||i===void 0||(r.value.getOption(c.value.editor.EditorOption.readOnly)?r.value.setValue(i):i!==r.value.getValue()&&(p.value=!0,r.value.executeEdits("",[{range:r.value.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),r.value.pushUndoStop(),p.value=!1))})),h(()=>e.language,u(i=>{var l,s;const v=(l=r.value)==null?void 0:l.getModel();v&&i&&((s=c.value)==null||s.editor.setModelLanguage(v,i))})),h(()=>e.line,u(i=>{var l;i!==void 0&&((l=r.value)==null||l.revealLine(i))}));const y=()=>{var i,l,s;if(!o.value||!c.value||r.value)return;n("beforeMount",c.value);const v=e.path||e.defaultPath,j=G(c.value,e.value||e.defaultValue||"",e.language||e.defaultLanguage||"",v||"");if(r.value=(i=c.value)==null?void 0:i.editor.create(o.value,Ge({model:j,theme:e.theme,automaticLayout:!0,autoIndent:"brackets",formatOnPaste:!0,formatOnType:!0},e.options),e.overrideServices),(l=r.value)==null||l.onDidChangeModelContent(m=>{if(!p.value){const N=r.value.getValue();n("update:value",N),n("change",N,m)}}),e.saveViewState){const m=P.get(v);m&&r.value.restoreViewState(m)}e.line!==void 0&&((s=r.value)==null||s.revealLine(e.line)),n("mount",r.value,c.value)};J(()=>{const i=h(()=>c.value,l=>{o.value&&l&&(Q(()=>i()),y())},{immediate:!0})}),ae(()=>{var i;(i=d.value)==null||i.call(d),r.value?M():f()});function M(){var i,l;e.keepCurrentModel&&(e.saveViewState?P.set(e.path,r.value.saveViewState()):(i=r.value.getModel())==null||i.dispose()),(l=r.value)==null||l.dispose()}return a}});export{Ye as M};
